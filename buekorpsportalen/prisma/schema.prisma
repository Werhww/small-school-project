generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int       @id @default(autoincrement())
  password     String    @unique
  role         Role      @default(MEMBER)
  companie     Companie?
  member       Member?
  parrent      Parrent?
  personalInfo Personal?
}

model Personal {
  id         Int      @id @default(autoincrement())
  firstName  String
  lastName   String
  birthDate  DateTime
  email      String   @unique
  phone      String   @unique
  picture    Bytes?
  address    String
  city       String
  postalCode String
  userId     Int      @unique
  user       User     @relation(fields: [userId], references: [id])

  @@map("UserPersonal")
}

model Parrent {
  id       Int      @id @default(autoincrement())
  userId   Int      @unique
  user     User     @relation(fields: [userId], references: [id])
  childern Member[] @relation("MemberToParrent")

  @@map("UserParrent")
}

model Member {
  id        Int       @id @default(autoincrement())
  userId    Int       @unique
  platoonId Int
  platoon   Platoon   @relation(fields: [platoonId], references: [id])
  user      User      @relation(fields: [userId], references: [id])
  parrents  Parrent[] @relation("MemberToParrent")
}

model Companie {
  id       Int       @id @default(autoincrement())
  name     String
  userId   Int       @unique
  user     User      @relation(fields: [userId], references: [id])
  platoons Platoon[]
}

model Platoon {
  id         Int      @id @default(autoincrement())
  name       String
  companieId Int
  members    Member[]
  companie   Companie @relation(fields: [companieId], references: [id])
}

enum Role {
  ADMIN
  MANAGER
  MEMBER
  PARRENT
}